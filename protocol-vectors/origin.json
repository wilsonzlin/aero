{
  "schema": 1,
  "normalize": [
    { "name": "null", "rawOriginHeader": "null", "normalizedOrigin": "null" },
    { "name": "null_whitespace", "rawOriginHeader": "  null  ", "normalizedOrigin": "null" },
    { "name": "basic_https", "rawOriginHeader": "https://example.com", "normalizedOrigin": "https://example.com" },
    { "name": "trim_and_lowercase", "rawOriginHeader": " https://Example.com ", "normalizedOrigin": "https://example.com" },
    { "name": "lowercase_scheme_and_host", "rawOriginHeader": "HTTPS://Example.COM", "normalizedOrigin": "https://example.com" },
    { "name": "allow_trailing_slash", "rawOriginHeader": "https://example.com/", "normalizedOrigin": "https://example.com" },
    { "name": "allow_trailing_slash_with_port", "rawOriginHeader": "http://localhost:5173/", "normalizedOrigin": "http://localhost:5173" },
    { "name": "strip_default_port_https", "rawOriginHeader": "https://example.com:443", "normalizedOrigin": "https://example.com" },
    { "name": "strip_default_port_https_trailing_slash", "rawOriginHeader": "https://example.com:443/", "normalizedOrigin": "https://example.com" },
    { "name": "strip_default_port_http", "rawOriginHeader": "http://example.com:80", "normalizedOrigin": "http://example.com" },
    { "name": "keep_non_default_port_https", "rawOriginHeader": "https://example.com:444", "normalizedOrigin": "https://example.com:444" },
    { "name": "keep_non_default_port_http", "rawOriginHeader": "http://example.com:8080", "normalizedOrigin": "http://example.com:8080" },
    { "name": "ipv4_octal", "rawOriginHeader": "http://010.0.0.1", "normalizedOrigin": "http://8.0.0.1" },
    { "name": "ipv4_octal_padded", "rawOriginHeader": "http://001.002.003.004", "normalizedOrigin": "http://1.2.3.4" },
    { "name": "ipv4_hex", "rawOriginHeader": "http://0x7f.0x0.0x0.0x1", "normalizedOrigin": "http://127.0.0.1" },
    { "name": "ipv4_shorthand", "rawOriginHeader": "http://127.1", "normalizedOrigin": "http://127.0.0.1" },
    { "name": "ipv4_32bit", "rawOriginHeader": "http://4294967295", "normalizedOrigin": "http://255.255.255.255" },
    { "name": "ipv6_http", "rawOriginHeader": "http://[::1]", "normalizedOrigin": "http://[::1]" },
    { "name": "ipv6_http_strip_default_port", "rawOriginHeader": "http://[::1]:80", "normalizedOrigin": "http://[::1]" },
    {
      "name": "ipv6_lowercase_and_strip_default_port_https",
      "rawOriginHeader": "https://[2001:DB8::1]:443/",
      "normalizedOrigin": "https://[2001:db8::1]"
    },
    {
      "name": "ipv6_expanded",
      "rawOriginHeader": "https://[2001:0DB8:0000:0000:0000:0000:0000:0001]:443/",
      "normalizedOrigin": "https://[2001:db8::1]"
    },
    {
      "name": "ipv6_v4_mapped",
      "rawOriginHeader": "http://[::FFFF:192.0.2.1]",
      "normalizedOrigin": "http://[::ffff:c000:201]"
    },

    { "name": "reject_empty", "rawOriginHeader": "", "expectError": true },
    { "name": "reject_whitespace_only", "rawOriginHeader": "   ", "expectError": true },
    { "name": "reject_relative_url", "rawOriginHeader": "/foo", "expectError": true },
    { "name": "reject_missing_scheme", "rawOriginHeader": "example.com", "expectError": true },
    { "name": "reject_non_http_scheme", "rawOriginHeader": "ftp://example.com", "expectError": true },
    { "name": "reject_credentials", "rawOriginHeader": "https://user:pass@example.com", "expectError": true },
    { "name": "reject_empty_userinfo", "rawOriginHeader": "https://@example.com", "expectError": true },
    { "name": "reject_query", "rawOriginHeader": "https://example.com/?q=1", "expectError": true },
    { "name": "reject_empty_query", "rawOriginHeader": "https://example.com?", "expectError": true },
    { "name": "reject_fragment", "rawOriginHeader": "https://example.com/#frag", "expectError": true },
    { "name": "reject_empty_fragment", "rawOriginHeader": "https://example.com#", "expectError": true },
    { "name": "reject_path", "rawOriginHeader": "https://example.com/path", "expectError": true },
    { "name": "reject_empty_port", "rawOriginHeader": "https://example.com:", "expectError": true },
    { "name": "reject_empty_port_slash", "rawOriginHeader": "https://example.com:/", "expectError": true },
    { "name": "reject_port_zero", "rawOriginHeader": "https://example.com:0", "expectError": true },
    { "name": "reject_invalid_ipv4_octal_digit", "rawOriginHeader": "http://08", "expectError": true },
    { "name": "reject_invalid_ipv4_octet", "rawOriginHeader": "http://256.0.0.1", "expectError": true },
    { "name": "reject_invalid_ipv4_all_octets", "rawOriginHeader": "http://999.999.999.999", "expectError": true },
    { "name": "reject_invalid_ipv4_overflow", "rawOriginHeader": "http://4294967296", "expectError": true },
    { "name": "reject_hostname_ends_in_number", "rawOriginHeader": "http://example.1", "expectError": true },
    { "name": "reject_percent_encoding", "rawOriginHeader": "https://%65xample.com", "expectError": true },
    { "name": "reject_tab", "rawOriginHeader": "https://example.com\t:443", "expectError": true },
    { "name": "reject_newline", "rawOriginHeader": "https://example.com\n.evil.com", "expectError": true },
    { "name": "reject_nbsp", "rawOriginHeader": "https://example.com\u00a0:443", "expectError": true },
    { "name": "reject_zero_width_space", "rawOriginHeader": "https://example.com\u200b:443", "expectError": true },
    { "name": "reject_unicode_domain", "rawOriginHeader": "https://مثال.إختبار", "expectError": true }
  ],
  "allow": [
    {
      "name": "allow_star_valid_origin",
      "allowedOrigins": ["*"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://evil.com",
      "expectAllowed": true
    },
    {
      "name": "deny_star_invalid_origin",
      "allowedOrigins": ["*"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "not a url",
      "expectAllowed": false
    },
    {
      "name": "deny_star_origin_with_empty_query",
      "allowedOrigins": ["*"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://evil.com?",
      "expectAllowed": false
    },
    {
      "name": "deny_star_origin_with_empty_fragment",
      "allowedOrigins": ["*"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://evil.com#",
      "expectAllowed": false
    },
    {
      "name": "allow_exact_match",
      "allowedOrigins": ["https://example.com"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": true
    },
    {
      "name": "deny_exact_mismatch",
      "allowedOrigins": ["https://example.com"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://other.com",
      "expectAllowed": false
    },
    {
      "name": "allow_exact_after_normalization",
      "allowedOrigins": ["https://example.com"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "HTTPS://EXAMPLE.COM:443",
      "expectAllowed": true
    },
    {
      "name": "deny_invalid_origin_when_allowlisted",
      "allowedOrigins": ["https://example.com"],
      "requestHost": "relay.example.com",
      "rawOriginHeader": "https://example.com/path",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_allows",
      "allowedOrigins": [],
      "requestHost": "example.com",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_default_port_https_in_host_header",
      "allowedOrigins": [],
      "requestHost": "example.com:443",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_default_port_http_in_host_header",
      "allowedOrigins": [],
      "requestHost": "example.com:80",
      "rawOriginHeader": "http://example.com",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_rejects_non_default_port_mismatch",
      "allowedOrigins": [],
      "requestHost": "example.com:444",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_allows_explicit_non_default_port",
      "allowedOrigins": [],
      "requestHost": "example.com:444",
      "rawOriginHeader": "https://example.com:444",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_rejects_wrong_port_for_scheme",
      "allowedOrigins": [],
      "requestHost": "example.com:80",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_rejects_invalid_request_host",
      "allowedOrigins": [],
      "requestHost": "example.com:",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_rejects_request_host_with_empty_query",
      "allowedOrigins": [],
      "requestHost": "example.com?",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_rejects_request_host_with_empty_fragment",
      "allowedOrigins": [],
      "requestHost": "example.com#",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_rejects_request_host_with_trailing_slash",
      "allowedOrigins": [],
      "requestHost": "example.com/",
      "rawOriginHeader": "https://example.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_case_insensitive",
      "allowedOrigins": [],
      "requestHost": "ExAmPlE.CoM",
      "rawOriginHeader": "https://EXAMPLE.COM",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_rejects_different_host",
      "allowedOrigins": [],
      "requestHost": "example.com",
      "rawOriginHeader": "https://other.com",
      "expectAllowed": false
    },
    {
      "name": "default_same_host_allows_ipv6",
      "allowedOrigins": [],
      "requestHost": "[::1]",
      "rawOriginHeader": "http://[::1]",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_ipv6_default_port",
      "allowedOrigins": [],
      "requestHost": "[::1]:80",
      "rawOriginHeader": "http://[::1]",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_ipv4_octal_in_origin",
      "allowedOrigins": [],
      "requestHost": "8.0.0.1",
      "rawOriginHeader": "http://010.0.0.1",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_ipv4_octal_in_host_header",
      "allowedOrigins": [],
      "requestHost": "010.0.0.1",
      "rawOriginHeader": "http://8.0.0.1",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_allows_ipv6_v4_mapped",
      "allowedOrigins": [],
      "requestHost": "[::ffff:c000:201]",
      "rawOriginHeader": "http://[::FFFF:192.0.2.1]",
      "expectAllowed": true
    },
    {
      "name": "default_same_host_rejects_ipv6_mismatch",
      "allowedOrigins": [],
      "requestHost": "[::2]",
      "rawOriginHeader": "http://[::1]",
      "expectAllowed": false
    },
    {
      "name": "allow_null_when_configured",
      "allowedOrigins": ["null"],
      "requestHost": "example.com",
      "rawOriginHeader": "null",
      "expectAllowed": true
    },
    {
      "name": "deny_null_by_default",
      "allowedOrigins": [],
      "requestHost": "example.com",
      "rawOriginHeader": "null",
      "expectAllowed": false
    }
  ]
}
