# Example environment file for deploy/docker-compose.yml
#
# Copy to deploy/.env and adjust values:
#   cp deploy/.env.example deploy/.env

# Domain / hostname to serve.
# - local dev: localhost
# - production: aero.example.com
AERO_DOMAIN=localhost

# HSTS toggle for production. 0 disables.
# Recommended production value: 31536000 (1 year) or higher.
AERO_HSTS_MAX_AGE=0

# Directory to serve as the static frontend root (mounted into Caddy at /srv).
# - Default: ./static (the smoke-test page under deploy/static/)
# - Recommended: ../web/dist (after building the real frontend)
#AERO_FRONTEND_ROOT=../web/dist

# Gateway image override (optional).
# - When unset, docker compose builds `backend/aero-gateway` from source.
#AERO_GATEWAY_IMAGE=ghcr.io/your-org/aero-gateway:latest

# Optional build arg used by backend/aero-gateway for /version.
#AERO_GATEWAY_GIT_SHA=$(git rev-parse HEAD)

# L2 tunnel proxy image override (optional).
# - When unset, docker compose builds `crates/aero-l2-proxy` from source.
#AERO_L2_PROXY_IMAGE=ghcr.io/your-org/aero-l2-proxy:latest

# WebRTC UDP relay image override (optional).
# - When unset, docker compose builds `proxy/webrtc-udp-relay` from source.
#AERO_WEBRTC_UDP_RELAY_IMAGE=ghcr.io/your-org/aero-webrtc-udp-relay:latest

# Optional: additional origins to allow in the edge proxy CSP `connect-src`.
# Example: "https://proxy.example.com wss://proxy.example.com"
#AERO_CSP_CONNECT_SRC_EXTRA=

# L2 tunnel proxy upstream (used by deploy/caddy/Caddyfile).
# Only change if your L2 proxy listens on a different host/port inside docker.
AERO_L2_PROXY_UPSTREAM=aero-l2-proxy:8090

# L2 proxy egress policy (recommended for production deployments).
# By default, the proxy denies private/reserved IP ranges but allows outbound to any public IP/port.
# Tighten this to reduce abuse/open-proxy risk:
#AERO_L2_ALLOWED_TCP_PORTS=80,443
#AERO_L2_ALLOWED_UDP_PORTS=
#AERO_L2_ALLOWED_DOMAINS=
#AERO_L2_BLOCKED_DOMAINS=
#AERO_L2_ALLOW_PRIVATE_IPS=0

# Gateway upstream (used by deploy/caddy/Caddyfile).
# Only change if your gateway listens on a different host/port inside docker.
#AERO_GATEWAY_UPSTREAM=aero-gateway:8080

# Pass-through env vars for `backend/aero-gateway`.
TRUST_PROXY=1
CROSS_ORIGIN_ISOLATION=0

# WebRTC UDP relay port range (must match the published UDP range in deploy/docker-compose.yml).
WEBRTC_UDP_PORT_MIN=50000
WEBRTC_UDP_PORT_MAX=50100

# Optional: append additional allowed browser origins for the UDP relay.
# Example: allow a separate dev server (only if it also sets COOP/COEP headers):
#AERO_WEBRTC_UDP_RELAY_ALLOWED_ORIGINS_EXTRA=,https://localhost:5173

# Auth for WebRTC UDP relay (proxy/webrtc-udp-relay) + gateway session integration.
#
# deploy/docker-compose.yml wires these into both:
# - aero-webrtc-udp-relay (enforces auth on /webrtc/* and /udp)
# - aero-gateway (mints udpRelay.token in POST /session and POST /udp-relay/token)
#
# NOTE: defaults are intentionally strict. When unset:
# - the relay defaults to AUTH_MODE=api_key and will return 401 on /webrtc/* until API_KEY is set
# - the gateway defaults to UDP_RELAY_AUTH_MODE=none (so /session won't include a udpRelay.token)
#
# Local dev convenience (no auth):
#AUTH_MODE=none
#
# API key auth (recommended if exposing the relay publicly):
#AUTH_MODE=api_key
#API_KEY=REPLACE_WITH_SECRET
#
# JWT auth (HS256):
#AUTH_MODE=jwt
#JWT_SECRET=REPLACE_WITH_SECRET
#UDP_RELAY_TOKEN_TTL_SECONDS=300

# UDP relay destination policy (highly recommended for public deployments).
# See proxy/webrtc-udp-relay/README.md for details.
#DESTINATION_POLICY_PRESET=production
#ALLOW_UDP_CIDRS=1.1.1.1/32,8.8.8.8/32
#ALLOW_UDP_PORTS=53

# Optional TURN (coturn) configuration (requires `--profile turn`).
# The coturn config defaults to user=aero:aero for local dev.
#AERO_TURN_URLS=turn:localhost:3478?transport=udp
#AERO_TURN_USERNAME=aero
#AERO_TURN_CREDENTIAL=aero
