/**
 * Minimal WASM payloads used by the browser-side JIT pipeline smoke test.
 *
 * Real Aero will generate these bytes dynamically from guest code (via the Rust
 * JIT compiled to wasm-bindgen), but the worker glue pipeline is identical.
 */

export const SHARED_MEMORY_INITIAL_PAGES = 1;
export const SHARED_MEMORY_MAX_PAGES = 16;

// WASM module exporting `jit_helper()`, which increments i32 at memory offset 4.
export const CPU_HELPER_WASM_BYTES = new Uint8Array([
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x04, 0x01, 0x60, 0x00, 0x00,
  0x02, 0x10, 0x01, 0x03, 0x65, 0x6e, 0x76, 0x06, 0x6d, 0x65, 0x6d, 0x6f,
  0x72, 0x79, 0x02, 0x03, 0x01, 0x10,
  0x03, 0x02, 0x01, 0x00,
  0x07, 0x0e, 0x01, 0x0a, 0x6a, 0x69, 0x74, 0x5f, 0x68, 0x65, 0x6c, 0x70,
  0x65, 0x72, 0x00, 0x00,
  0x0a, 0x11, 0x01, 0x0f, 0x00, 0x41, 0x04, 0x41, 0x04, 0x28, 0x02, 0x00,
  0x41, 0x01, 0x6a, 0x36, 0x02, 0x00, 0x0b,
]) as Uint8Array<ArrayBuffer>;

// WASM module exporting `block()`, which calls imported `cpu.jit_helper()` then increments i32 at memory offset 0.
export const JIT_BLOCK_WASM_BYTES = new Uint8Array([
  0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,
  0x01, 0x04, 0x01, 0x60, 0x00, 0x00,
  0x02, 0x21, 0x02,
  0x03, 0x65, 0x6e, 0x76, 0x06, 0x6d, 0x65, 0x6d, 0x6f, 0x72, 0x79, 0x02,
  0x03, 0x01, 0x10,
  0x03, 0x63, 0x70, 0x75, 0x0a, 0x6a, 0x69, 0x74, 0x5f, 0x68, 0x65, 0x6c,
  0x70, 0x65, 0x72, 0x00, 0x00,
  0x03, 0x02, 0x01, 0x00,
  0x07, 0x09, 0x01, 0x05, 0x62, 0x6c, 0x6f, 0x63, 0x6b, 0x00, 0x01,
  0x0a, 0x13, 0x01, 0x11, 0x00, 0x10, 0x00, 0x41, 0x00, 0x41, 0x00, 0x28,
  0x02, 0x00, 0x41, 0x01, 0x6a, 0x36, 0x02, 0x00, 0x0b,
]) as Uint8Array<ArrayBuffer>;

export function copyWasmBytes(bytes: Uint8Array<ArrayBuffer>): Uint8Array<ArrayBuffer> {
  return new Uint8Array(bytes) as Uint8Array<ArrayBuffer>;
}
