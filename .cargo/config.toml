# Repo-tracked Cargo config.
#
# Keep this file minimal to avoid impacting CI. Agent-only build/memory limits are
# applied via environment variables in `scripts/agent-env.sh`.

[env]
# Some environments configure Cargo to use `sccache` via a global Cargo config or
# environment variables. In ephemeral agent sandboxes the sccache server is not
# always available, which causes *all* cargo commands to fail before compilation
# even starts.
#
# Default to no rustc wrapper for this repo. Developers/CI that want sccache can
# opt back in by setting `CARGO_BUILD_RUSTC_WRAPPER=sccache` / `RUSTC_WRAPPER=sccache`
# (or `CARGO_BUILD_RUSTC_WORKSPACE_WRAPPER=sccache` / `RUSTC_WORKSPACE_WRAPPER=sccache`)
# or by overriding the corresponding `build.*wrapper` keys in a higher-precedence Cargo config.
CARGO_BUILD_RUSTC_WRAPPER = ""
CARGO_BUILD_RUSTC_WORKSPACE_WRAPPER = ""
#
# Some sandbox environments ship with a broken `sccache` wrapper via environment
# variables. Keep these in addition to the `[build]` overrides below so `cargo`
# invocations from within the repo are resilient even when wrappers are exported
# globally.
RUSTC_WRAPPER = ""
RUSTC_WORKSPACE_WRAPPER = ""

[alias]
# `cargo xtask <subcommand>` is shorthand for running the `xtask` helper binary.
xtask = "run --locked -p xtask --"

[build]
# Some sandbox environments configure Cargo wrappers (e.g. `build.rustc-wrapper = "sccache"`)
# globally. When that daemon/socket is broken, Cargo will fail before compiling anything.
#
# Setting explicit (empty) wrappers here overrides any inherited global config.
# Developers can still opt back in per-invocation by exporting `RUSTC_WRAPPER=sccache` (or
# `RUSTC_WORKSPACE_WRAPPER=sccache`).
rustc-wrapper = ""
rustc-workspace-wrapper = ""
