# SPDX-License-Identifier: MIT OR Apache-2.0
#
# virtio-snd (Windows 7) - clean-room PortCls (WaveRT) audio driver.
#
# Build with the WinDDK 7600 "build" utility from:
#   drivers\windows7\virtio-snd
#
# x86: use the Win7 x86 Free/Checked build environment.
# x64: use the Win7 x64 Free/Checked build environment.

TARGETNAME=aero_virtio_snd
TARGETTYPE=DRIVER
TARGETPATH=obj

#
# This driver links against:
#   - canonical virtio-pci modern transport: drivers/windows/virtio/pci-modern
#   - shared split-ring virtqueue engine: drivers/windows/virtio/common
#
INCLUDES=$(INCLUDES);..\include;..\..\..\windows\virtio\common;..\..\..\windows\virtio\pci-modern;..\..\virtio\common\include;..\..\..\win7\virtio\virtio-core\include;..\..\..\win7\virtio\virtio-core\portable

TARGETLIBS=$(TARGETLIBS) \
  $(DDK_LIB_PATH)\portcls.lib \
  $(DDK_LIB_PATH)\ks.lib

SOURCES= \
    adapter.c \
    adapter_context.c \
    backend_null.c \
    backend_virtio.c \
    topology.c \
    wavert.c \
    pci_interface.c \
    ..\..\virtio\common\src\virtio_pci_intx_wdm.c \
    ..\..\virtio\common\src\virtio_pci_contract.c \
    virtio_snd_proto.c \
    virtiosnd_control.c \
    virtiosnd_control_proto.c \
    virtiosnd_contract.c \
    virtiosnd_dma.c \
    virtiosnd_eventq.c \
    virtiosnd_queue_split.c \
    virtiosnd_tx.c \
    virtiosnd_rx.c \
    virtiosnd_hw.c \
    virtiosnd_intx.c \
    virtiosnd_jack.c \
    virtiosnd_sg.c \
    virtiosnd_sg_core.c \
    virtiosnd_sg_tx.c \
    ..\..\..\windows\virtio\common\virtqueue_split.c \
    ..\..\..\windows\virtio\pci-modern\virtio_pci_modern_transport.c \
    ..\..\..\win7\virtio\virtio-core\portable\virtio_pci_cap_parser.c \
    ..\..\..\win7\virtio\virtio-core\portable\virtio_pci_identity.c
