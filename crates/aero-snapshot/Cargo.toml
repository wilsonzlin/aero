[package]
name = "aero-snapshot"
version = "0.1.0"
edition = "2021"
license = "MIT OR Apache-2.0"

[features]
default = ["io-snapshot"]
io-snapshot = ["dep:aero-io-snapshot"]

[dependencies]
aero-io-snapshot = { path = "../aero-io-snapshot", optional = true }
aero-cpu-core = { path = "../aero-cpu-core" }
lz4_flex = "0.11"
thiserror = "1"

[target.'cfg(not(target_arch = "wasm32"))'.dev-dependencies]
aero-devices-input = { path = "../aero-devices-input" }
aero-net-e1000 = { path = "../aero-net-e1000", features = ["io-snapshot"] }
memory = { path = "../memory" }
aero-net-stack = { path = "../aero-net-stack" }
proptest = "1.5"
rand = "0.8"

[[test]]
name = "io_snapshot_bridge"
path = "tests/io_snapshot_bridge.rs"
required-features = ["io-snapshot"]

[[test]]
name = "network_device_roundtrip"
path = "tests/network_device_roundtrip.rs"
required-features = ["io-snapshot"]

[[test]]
name = "network_device_blobs_roundtrip"
path = "tests/network_device_blobs_roundtrip.rs"
required-features = ["io-snapshot"]

[[test]]
name = "net_stack_legacy_io_snapshot_bridge"
path = "tests/net_stack_legacy_io_snapshot_bridge.rs"
required-features = ["io-snapshot"]

[[test]]
name = "e1000_io_snapshot_bridge"
path = "tests/e1000_io_snapshot_bridge.rs"
required-features = ["io-snapshot"]
