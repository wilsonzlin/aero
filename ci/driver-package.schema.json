{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Aero driver packaging manifest",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Optional JSON Schema reference for editor tooling (example: \"../../ci/driver-package.schema.json\"). CI ignores this field.",
      "minLength": 1
    },
    "infFiles": {
      "type": "array",
      "description": "Optional list of INF files (paths relative to the driver directory) to stage for this driver. If omitted, CI discovers all .inf files under the driver directory. Use this to disambiguate drivers that ship multiple INFs (e.g. optional feature variants) that should not be packaged together. If present, the list must be non-empty. Paths must resolve under the driver directory (no absolute paths; cannot escape the driver directory). CI stages selected INFs into the package root by file name; ensure INF file names are unique within the driver.",
      "minItems": 1,
      "items": {
        "type": "string",
        "minLength": 1,
        "pattern": "^.+\\.[iI][nN][fF]$"
      },
      "uniqueItems": true
    },
    "wow64Files": {
      "type": "array",
      "description": "Optional list of WOW64 payload files to copy from the x86 build output into the x64 staged package directory *before* stamping INFs and running Inf2Cat. Entries must be .dll file names only (no path separators). Intended for x64 driver packages that also need 32-bit user-mode components (WOW64 UMD DLLs). Requires x86 build outputs to be present even when generating/staging x64 packages. WOW64 payloads are copied into the x64 package root; ensure file names do not collide with 64-bit build outputs (use distinct names such as a '_x64' suffix).",
      "items": {
        "type": "string",
        "minLength": 1,
        "pattern": "^[^\\\\/]+\\.[dD][lL][lL]$"
      },
      "uniqueItems": true
    },
    "additionalFiles": {
      "type": "array",
      "description": "Additional files (paths relative to the driver directory) to include in the staged driver package. Intended for non-binary files such as README/license text or install scripts. Paths must resolve under the driver directory (no absolute paths; cannot escape the driver directory). CI refuses to include common binary extensions via this mechanism (currently: .sys, .dll, .exe, .cat, .msi, .cab).",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "uniqueItems": true
    },
    "wdfCoInstaller": {
      "type": "object",
      "description": "If present, this driver package requires a WDF coinstaller (WdfCoInstaller*.dll) for older systems. This file is a Microsoft WDK redistributable and is NOT included by default (see docs).",
      "additionalProperties": false,
      "required": ["kmdfVersion"],
      "properties": {
        "kmdfVersion": {
          "type": "string",
          "description": "KMDF version required by this driver (e.g. 1.9, 1.11, 1.15). Used to derive the default DLL name if dllName is omitted.",
          "pattern": "^\\d+\\.\\d+$"
        },
        "dllName": {
          "type": "string",
          "description": "Optional explicit DLL filename (e.g. WdfCoInstaller01011.dll). If omitted, CI derives it from kmdfVersion.",
          "pattern": "^WdfCoInstaller\\d{5}\\.dll$"
        }
      }
    }
  }
}
